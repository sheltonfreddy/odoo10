<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="booked_hotels_view_form" model="ir.ui.view">
            <field name="name">booked_hotels.view.form</field>
            <field name="model">booked.hotels</field>
            <field name="arch" type="xml">
                <form string="Booked Hotels">
                   <header>
                   		<!-- <button name="action_view_invoice" type="object" string="View Invoice"
                   		       states="confirmed"/> -->
                   		<button name="create_invoice" type="object" string="Invoice"
                   		     states="confirmed"/>
                   		<button name="action_cancel_booking" type="object" string="Cancel Booking"
                   		     states="confirmed"/>
                   	    <!-- <button name="print_receipt" type="object" class="btn-primary" string="Print Receipt"/>  -->
<!--                    		<button name="action_get_cancellation_policies" type="object" string="GetCancellationPolicies" -->
<!--                    		       states="confirmed"/>      -->
                   		
                   		<field name="state" widget="statusbar" statusbar_visible="draft,confirmed,cancel" 
                   		     statusbar_colors='{"confirmed":"blue","cancel":"red"}'/>
                   </header>
                   <sheet string="Booked Hotels">
                   <h1>
                        <label string="Booking Number"/>
                        <field name="name" class="oe_inline" readonly="1"/>
                    </h1>
                    <group>
                        <group>
	                        <field name="customer_id"/>
	                        
	                        <field name="reference" string="Booking Reference"/>
	                        <field name="booking_type" invisible="1"/>
	                        <field name="hotel"/>
	                        <field name="hotel_id"/>
	                        <field name="destinationName"/>
	                        <field name="holder_name"/>
	                        <field name="holder_surname"/>
                        </group>
                        <group>
	                        <field name="check_in"/>
	                        <field name="check_out"/>
	                        <field name="booked_user_id"/>
	                        <field name="creationDate"/>
	                        <field name="remark"/>
	                        <field name="agency_currency_id"/>
	                        
	                        <field name="currency" invisible="1"/>
	                        <field name="no_of_nights"/>
	                        <field name="total_rate" nolabel="1" invisible="1"/>
                        </group>
                        <group col="3" colspan="4">
                        	<field colspan="2" name="cancellation_fee" invisible="1"/>
                        	<field name="cancellation_fee_currency" nolabel="1" invisible="1"/>
                        </group>
                        <field colspan="4" name="invoice_id" invisible="1"/>
                        <field colspan="4" name="reservationId" invisible="1"/>
                        <field colspan="2" invisible="1" name="pendingAmount"/>
                        <separator string="Room Booked" colspan="4"/>
                        <field colspan="4" name="booked_rooms" nolabel="1">
                        	<tree editable="bottom">
                        		<field name="name"/>
                        		<field name="status"/>
                        		<field name="rate_currency"/>
                        	</tree>
                        </field>
                        <group class="oe_subtotal_footer oe_right">
                        	<field name="amount_exc_markup"/>
                        	<field name="markup_percent" string="Markup %"/>
                        	<field name="amount_total"/>
                        </group>
                    </group>
                </sheet>
                </form>
            </field>
        </record>
        
        <record id="booked_hotels_view_form_inherit" model="ir.ui.view">
	        <field name="name">booked_hotels.view.form.inherit</field>
	        <field name="model">booked.hotels</field>
	        <field name="inherit_id" ref="booked_hotels_view_form"/>
	        <field name="groups_id" eval="[(4,ref('base.group_agency_admin'))]"/>
	        <field name="arch" type="xml">
	            <xpath expr="//field[@name='booking_type']" position="attributes">
                   <attribute name="invisible">False</attribute>                   
                </xpath>    
        	</field>
    	</record>

         <record id="booked_hotels_view_tree" model="ir.ui.view">
            <field name="name">booked_hotels.view.tree</field>
            <field name="model">booked.hotels</field>
            <field name="arch" type="xml">
                <tree string="Booked Hotels">
                	<field name="customer_id"/>
                    <field name="name"/>
                    <field name="booking_type"/>
                    <field name="hotel"/>
                    <field name="check_in"/>
                    <field name="check_out"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="booked_hotels_view_search" model="ir.ui.view">
            <field name="name">booked_hotels.view.search</field>
            <field name="model">booked.hotels</field>
            <field name="arch" type="xml">
                <search string="Booked Hotels">
                    <field name="name"/>
                    <field name="booking_type"/>
                    <field name="hotel"/>
                    <field name="check_in"/>
                    <field name="check_out"/>
                    <field name="customer_id"/>
               </search>
            </field>
        </record>

        <record id="action_booked_hotels" model="ir.actions.act_window">
            <field name="name">Booked Hotels</field>
            <field name="res_model">booked.hotels</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="booked_hotels_view_search"/>
        </record>
        
        <record id="booking_type_view_form" model="ir.ui.view">
            <field name="name">booking_type.view.form</field>
            <field name="model">booking.type</field>
            <field name="arch" type="xml">
                <form string="Booking Type">
                	<group>
	                	<field name="name"/>
	                    <field name="type"/>
	                    <field name="count_booked_cancel"/>
	                    <field name="type"/>
	                </group>
                </form>
            </field>
        </record>
        
        <record id="bookeing_type_view_tree" model="ir.ui.view">
            <field name="name">bookeing_type.view.tree</field>
            <field name="model">booking.type</field>
            <field name="arch" type="xml">
                <tree string="Booking Type">
                	<field name="name"/>
                    <field name="type"/>
                </tree>
            </field>
        </record>
        
        <record id="action_booking_type" model="ir.actions.act_window">
            <field name="name">Booking Type</field>
            <field name="res_model">booking.type</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>
        <menuitem action="action_booking_type" id="menu_booking_type" 
        		parent="menu_configuration" name="Booking Type" 
        		sequence="20" groups="base.group_erp_manager"/>
        
        <menuitem action="action_booked_hotels" id="menu_booked_hotels" 
        		parent="menu_main_hotels" name="Booked Hotels" 
        		sequence="20"/>
        		
        		
        <record id="booked_type_kanban" model="ir.ui.view">
            <field name="name">booked.type.kanban</field>
            <field name="model">booking.type</field>
            <field name="arch" type="xml">
                <kanban class="oe_background_grey o_kanban_dashboard o_stock_kanban" create="0">
                    <field name="color"/>
                    <field name="count_booked_cancel"/>
                    <field name="name"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div  name="booked_hotels">
                                <div t-attf-class="#{kanban_color(record.color.raw_value)}">
                                    <div class="o_kanban_card_header">
                                        <div class="o_kanban_card_header_title">
                                            <div class="o_primary">
                                                <a type="object" name="get_hotelbeds_bookings">
                                                    <field name="name" invisible="1"/>
                                                    <field name="type"/>
                                                    <field name="count_booked_invoiced_tourico" invisible="1"/>
                                                    <field name="count_booked_invoiced_hotelbeds" invisible="1"/>
                                                </a>
                                            </div>
                                            <!--div class="o_secondary"><field class="o_secondary"  name="warehouse_id"/></div-->
                                        </div>
                                        <!-- div class="o_kanban_manage_button_section">
                                            <a class="o_kanban_manage_toggle_button" href="#">More <i class="fa fa-caret-down"/></a>
                                        </div-->
                                    </div>
                                    <div class="container o_kanban_card_content o_visible">
                                        <div class="row">
                                            <div class="col-xs-6 o_kanban_primary_left">
                                                <button class="btn btn-primary" name="get_hotelbeds_bookings" type="object">
                                                    <span t-if="record.type.value =='Hotelbeds'"><t t-esc="record.count_booked_invoiced_hotelbeds.value"/> Invoiced</span>
                                                    <span t-if="record.type.value =='Tourico'"><t t-esc="record.count_booked_invoiced_tourico.value"/> Invoiced</span>
                                                    
                                                </button>
                                            </div>
                                            <div class="col-xs-6 o_kanban_primary_right">

                                                <div t-if="record.count_booked_cancel.raw_value > 0" class="row">
                                                    <div class="col-xs-9">
                                                        <a name="get_action_bookings_cancel" type="object">
                                                            Cancelled
                                                        </a>
                                                    </div>
                                                    <div class="col-xs-3">
                                                        <field name="count_booked_cancel"/>
                                                    </div>
                                                </div>


                                            </div>
                                        </div>
                                    </div><!--div class="container o_kanban_card_manage_pane o_invisible">
                                        <div class="row">
                                            <div class="col-xs-6 o_kanban_card_manage_section o_kanban_manage_view">
                                                <div class="o_kanban_card_manage_title">
                                                    <span>View</span>
                                                </div>
                                                <div>
                                                    <a name="get_stock_picking_action_picking_type" type="object">All</a>
                                                </div>
                                                <div>
                                                    <a name="(action_picking_tree_ready)d" type="action">Ready</a>
                                                </div>
                                                <div>
                                                    <a name="get_action_picking_tree_waiting" type="object">Waiting</a>
                                                </div>
                                            </div>
                                            <div class="col-xs-6 o_kanban_card_manage_section o_kanban_manage_new">
                                                <div class="o_kanban_card_manage_title">
                                                    <span>New</span>
                                                </div>
                                                <div>
                                                    <a name="(action_picking_form)d" type="action" >Transfer</a>
                                                </div>
                                            </div>
                                        </div>

                                        <div t-if="widget.editable" class="o_kanban_card_manage_settings row">
                                            <div class="col-xs-8">
                                                <ul class="oe_kanban_colorpicker" data-field="color"/>
                                            </div>
                                            <div class="col-xs-4 text-right">
                                                <a type="edit">Settings</a>
                                            </div>
                                        </div>
                                    </div-->
                                </div>
                            </div>
                        </t>
                    
                    </templates>
                </kanban>
            </field>
        </record>
        
        <record id="booked_type_action" model="ir.actions.act_window">
            <field name="name">Bookings</field>
            <field name="res_model">booking.type</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,form</field>
        </record>
        
        <record id="booked_hotels_hotelbeds" model="ir.actions.act_window">
            <field name="name">HotelBeds Bookings</field>
            <field name="res_model">booked.hotels</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="domain"></field>
            <!-- field name="context">{
                    'search_default_picking_type_id': [active_id],
                    'default_picking_type_id': active_id,
                    'contact_display': 'partner_address',
            }
            </field>
            <field name="search_view_id" ref="view_picking_internal_search"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click here to create a new transfer.
              </p><p>
                You can either do it immediately or mark it as Todo for future processing. Use your scanner to validate the transferred quantity quicker.
              </p>
            </field-->
        </record>
        
        <menuitem name="Dashboard" id="hotel_dashboard" parent="menu_root_hotels" groups="base.group_erp_manager,base.group_hotel_booking_manager,base.group_agency_admin"/>
<menuitem  id="hotel_dashboard_menu" parent="hotel_dashboard" sequence="0" name="Hotel Dashboard" action="booked_type_action" groups="base.group_erp_manager,base.group_hotel_booking_manager,base.group_agency_admin"/>
        		
    </data>
</openerp>